<!DOCTYPE html>
<html lang=en>
    <head>
        <script src = "https://cdn.rawgit.com/mrdoob/three.js/r84/build/three.js"></script>
        <script src = "https://sdk.altvr.com/libs/altspace.js/2.9.0/altspace.min.js"></script>
        <script src = "https://cdnjs.cloudflare.com/ajax/libs/tween.js/16.3.5/Tween.min.js"></script>
        <script src = "https://cdn.rawgit.com/NGenesis/altspacevr-behaviors/v0.9.9/js/altspaceutil.min.js"></script>
        <script src = "../motion/motion.js"></script>
    </head>
    <body>
        <script>
            var skyDayURL = "https://img-new.cgtrader.com/items/30329/skybox_017_3d_model_7d6d02d0-afed-484f-b6f9-cf2d9d0476a5.jpg";
            var skyNightURL = "https://cmdrflexo.github.io/AltspaceSDK-Flexo/examples/flexo/images/sky/galaxy.jpg";

            altspace.getEnclosure().then(function(enclosure) {
                enclosure.requestFullspace().then(function() {
                    enclosure.addEventListener('fullspacechange', function() {
                        if(!enclosure.fullspace) enclosure.requestFullspace();
                    });

                    sim = new altspace.utilities.Simulation();

                    var groundPlane = new THREE.Mesh(
                        new THREE.PlaneGeometry(10000, 1, 1),
                        new THREE.MeshBasicMaterial({ color: 0x40591f })
                    )
                    groundPlane.rotation.x = 90;
            
                    var skySphere = new THREE.Mesh(
                        new THREE.SphereGeometry(1500, 32, 16),
                        new THREE.MeshBasicMaterial(
                            {
                                color: 0xffffff, 
                                transparent : true,
                                opacity : 0.5,
                                map: new THREE.Texture(
                                    { 
                                        src: altspaceutil.getAbsoluteURL(skyNightURL)
                                    }
                                )
                            }
                        )
                    );

                    skySphere.scale.x = -1;
                    skySphere.addBehavior(new SkyRotate(1000));
                    skySphere.addBehavior(new SkyFade(1, 1));

                    sim.scene.add(skySphere);
                });
            });
        </script>
    </body>
</html>
